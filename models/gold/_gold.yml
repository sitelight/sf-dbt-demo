version: 2

models:
  - name: mart_sales_daily
    description: >
      Daily sales performance metrics for executive dashboards and reporting.
      Incremental model with date clustering for optimal query performance.
      Showcases Fusion Engine's cost optimization through selective processing.
    config:
      tags: ['gold', 'mart', 'sales']
    columns:
      - name: date_day
        description: Date of sales activity (Primary Key, Clustered)
        tests:
          - unique
          - not_null
      - name: net_revenue
        description: Total revenue after discounts for completed orders
        tests:
          - not_null
      - name: total_orders
        description: Count of all orders placed on this day
        tests:
          - not_null
      - name: completed_orders
        description: Count of completed orders
      - name: order_completion_rate_pct
        description: Percentage of orders that were completed
      - name: avg_order_value
        description: Average grand total for completed orders
      - name: revenue_per_customer
        description: Average revenue per active customer

  - name: mart_customer_lifetime_value
    description: >
      Customer lifetime value analysis with RFM segmentation and value tiers.
      Enables targeted marketing campaigns and customer retention strategies.
      Demonstrates column-level lineage for PII tracking (email addresses).
    config:
      tags: ['gold', 'mart', 'customers', 'clv']
    columns:
      - name: customer_id
        description: Unique customer identifier (Primary Key)
        tests:
          - unique
          - not_null
      - name: customer_lifetime_value
        description: Total historical revenue from this customer
        tests:
          - not_null
      - name: rfm_segment
        description: RFM-based customer segment for marketing
        tests:
          - not_null
          - accepted_values:
              values: ['Champions', 'Loyal Customers', 'Promising', 'Potential Loyalists', 'At Risk', 'Lost', 'Need Attention']
      - name: customer_value_tier
        description: Customer value classification
        tests:
          - accepted_values:
              values: ['Platinum', 'Gold', 'Silver', 'Bronze', 'No Purchase']
      - name: lifetime_profit
        description: Total profit generated from this customer
      - name: profit_margin_pct
        description: Overall profit margin percentage for customer

  - name: mart_product_performance
    description: >
      Product sales performance, profitability, and inventory health analysis.
      Supports inventory optimization, pricing strategies, and product recommendations.
    config:
      tags: ['gold', 'mart', 'products']
    columns:
      - name: product_id
        description: Unique product identifier (Primary Key)
        tests:
          - unique
          - not_null
      - name: product_name
        description: Name of the product
        tests:
          - not_null
      - name: total_revenue
        description: Total revenue generated by this product
        tests:
          - not_null
      - name: total_profit
        description: Total profit from this product
        tests:
          - not_null
      - name: sales_velocity
        description: Product sales performance classification
        tests:
          - accepted_values:
              values: ['Never Sold', 'Slow Mover', 'Moderate Seller', 'Good Seller', 'Best Seller']
      - name: inventory_health
        description: Inventory status assessment
        tests:
          - accepted_values:
              values: ['Out of Stock', 'Overstock Risk', 'Reorder Soon', 'Monitor Stock', 'Healthy']
      - name: performance_score
        description: Composite performance score (higher is better)
      - name: is_top_revenue_product
        description: Flag for top 5 products by revenue
      - name: is_top_profit_product
        description: Flag for top 5 products by profit
